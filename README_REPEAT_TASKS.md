# 重複任務功能說明

## 功能概述

本次更新為手繪風格任務管理系統新增了重複任務功能，讓用戶可以輕鬆創建每日、每週、每月或每年的重複任務。

## 新增功能

### 1. 重複任務類型
- **每日重複**：任務每天重複執行
- **每週重複**：任務每週重複執行
- **每月重複**：任務每月重複執行
- **每年重複**：任務每年重複執行

### 2. 重複間隔設定
- 可設定重複的頻率（例如：每2天、每3週等）
- 支援1-365的間隔範圍

### 3. 重複結束日期
- 可設定重複任務的結束日期
- 不設定則預設重複一年

## 使用方法

### 創建重複任務

1. 點擊「新增任務」按鈕
2. 填寫任務基本信息（標題、描述、時間等）
3. 在「重複」選項中選擇重複類型
4. 設定重複間隔（可選）
5. 設定重複結束日期（可選）
6. 點擊「儲存」按鈕

### 重複任務顯示

- 重複任務會在任務卡片上顯示重複類型標籤
- 重複任務會顯示「重複任務」標籤
- 重複任務會自動出現在對應的日期中

## 技術實現

### 後端更新

#### Task模型
- 新增 `repeatType` 字段：重複類型枚舉
- 新增 `repeatInterval` 字段：重複間隔
- 新增 `repeatEndDate` 字段：重複結束日期
- 新增 `originalTaskId` 字段：原始任務ID

#### TaskService
- 新增 `createRepeatingTasks` 方法：創建重複任務
- 新增 `getRepeatingTasks` 方法：獲取重複任務
- 新增 `deleteRepeatingTasks` 方法：刪除重複任務

#### TaskController
- 新增 `POST /api/tasks/{id}/repeat` 端點：創建重複任務
- 新增 `GET /api/tasks/{id}/repeating` 端點：獲取重複任務
- 新增 `DELETE /api/tasks/{id}/repeating` 端點：刪除重複任務

### 前端更新

#### HTML表單
- 新增重複類型選擇下拉選單
- 新增重複間隔輸入欄位
- 新增重複結束日期選擇器

#### JavaScript功能
- 新增重複選項的動態顯示/隱藏
- 新增重複任務的創建邏輯
- 新增重複任務的標籤顯示

#### CSS樣式
- 新增重複任務標籤的樣式
- 新增重複選項表單的樣式

## 數據庫更新

需要在現有的 `tasks` 表中添加以下字段：

```sql
ALTER TABLE tasks ADD COLUMN repeat_type VARCHAR(20) DEFAULT 'NONE';
ALTER TABLE tasks ADD COLUMN repeat_interval INT DEFAULT 1;
ALTER TABLE tasks ADD COLUMN repeat_end_date DATETIME NULL;
ALTER TABLE tasks ADD COLUMN original_task_id BIGINT NULL;
```

## 使用範例

### 每日重複任務
- 任務：晨跑
- 重複類型：每日
- 重複間隔：1
- 時間：每天早上6:00

### 每週重複任務
- 任務：團隊會議
- 重複類型：每週
- 重複間隔：1
- 時間：每週一上午10:00

### 每月重複任務
- 任務：繳納水電費
- 重複類型：每月
- 重複間隔：1
- 時間：每月1號

## 注意事項

1. **重複任務限制**：系統最多創建1000個重複任務，防止無限循環
2. **編輯重複任務**：重複任務創建後，每個實例可以獨立編輯
3. **刪除重複任務**：刪除原始任務時，可以選擇是否同時刪除所有重複任務
4. **性能考慮**：大量重複任務可能影響系統性能，建議合理設定重複範圍

## 未來改進

1. **智能重複**：支援工作日重複、節假日跳過等
2. **重複規則編輯**：允許用戶編輯重複規則
3. **批量操作**：支援批量編輯重複任務
4. **重複統計**：顯示重複任務的完成統計

## 版本信息

- **版本**：1.1.0
- **更新日期**：2024年8月16日
- **更新內容**：新增重複任務功能
- **兼容性**：向後兼容，不影響現有功能
